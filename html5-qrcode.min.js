s.getStartX():s.getEndX();if(nr.isValidBarcodeColumn(t,e-i)&&(s=t.getDetectionResultColumn(e-i).getCodewordNearby(r)),null!=s)return n?s.getEndX():s.getStartX();let o=0;for(;nr.isValidBarcodeColumn(t,e-i);){e-=i;for(let r of t.getDetectionResultColumn(e).getCodewords())if(null!=r)return(n?r.getEndX():r.getStartX())+i*o*(r.getEndX()-r.getStartX());o++}return n?t.getBoundingBox().getMinX():t.getBoundingBox().getMaxX()}static detectCodeword(t,e,r,n,i,s,o,a){i=nr.adjustCodewordStartColumn(t,e,r,n,i,s);let l,h=nr.getModuleBitCount(t,e,r,n,i,s);if(null==h)return null;let c=tt.sum(h);if(n)l=i+c;else{for(let t=0;t<h.length/2;t++){let e=h[t];h[t]=h[h.length-1-t],h[h.length-1-t]=e}i=(l=i)-c}if(!nr.checkCodewordSkew(c,o,a))return null;let u=Ye.getDecodedValue(h),d=be.getCodeword(u);return-1===d?null:new ze(i,l,nr.getCodewordBucketNumber(u),d)}static getModuleBitCount(t,e,r,n,i,s){let o=i,a=new Int32Array(8),l=0,h=n?1:-1,c=n;for(;(n?o<r:o>=e)&&l<a.length;)t.get(o,s)===c?(a[l]++,o+=h):(l++,c=!c);return l===a.length||o===(n?r:e)&&l===a.length-1?a:null}static getNumberOfECCodeWords(t){return 2<<t}static adjustCodewordStartColumn(t,e,r,n,i,s){let o=i,a=n?-1:1;for(let l=0;l<2;l++){for(;(n?o>=e:o<r)&&n===t.get(o,s);){if(Math.abs(i-o)>nr.CODEWORD_SKEW_SIZE)return i;o+=a}a=-a,n=!n}return o}static checkCodewordSkew(t,e,r){return e-nr.CODEWORD_SKEW_SIZE<=t&&t<=r+nr.CODEWORD_SKEW_SIZE}static decodeCodewords(t,e,r){if(0===t.length)throw E.getFormatInstance();let n=1<<e+1,i=nr.correctErrors(t,r,n);nr.verifyCodewordCount(t,n);let s=rr.decode(t,""+e);return s.setErrorsCorrected(i),s.setErasures(r.length),s}static correctErrors(t,e,r){if(null!=e&&e.length>r/2+nr.MAX_ERRORS||r<0||r>nr.MAX_EC_CODEWORDS)throw l.getChecksumInstance();return nr.errorCorrection.decode(t,r,e)}static verifyCodewordCount(t,e){if(t.length<4)throw E.getFormatInstance();let r=t[0];if(r>t.length)throw E.getFormatInstance();if(0===r){if(!(e<t.length))throw E.getFormatInstance();t[0]=t.length-e}}static getBitCountForCodeword(t){let e=new Int32Array(8),r=0,n=e.length-1;for(;!((1&t)!==r&&(r=1&t,--n<0));)e[n]++,t>>=1;return e}static getCodewordBucketNumber(t){return t instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(t):this.getCodewordBucketNumber_number(t)}static getCodewordBucketNumber_number(t){return nr.getCodewordBucketNumber(nr.getBitCountForCodeword(t))}static getCodewordBucketNumber_Int32Array(t){return(t[0]-t[2]+t[4]-t[6]+9)%9}static toString(t){let e=new Ue;for(let r=0;r<t.length;r++){e.format("Row %2d: ",r);for(let n=0;n<t[r].length;n++){let i=t[r][n];0===i.getValue().length?e.format("        ",null):e.format("%4d(%2d)",i.getValue()[0],i.getConfidence(i.getValue()[0]))}e.format("%n")}return e.toString()}}nr.CODEWORD_SKEW_SIZE=2,nr.MAX_ERRORS=3,nr.MAX_EC_CODEWORDS=512,nr.errorCorrection=new ke;class ir{decode(t,e=null){let r=ir.decode(t,e,!1);if(null==r||0===r.length||null==r[0])throw R.getNotFoundInstance();return r[0]}decodeMultiple(t,e=null){try{return ir.decode(t,e,!0)}catch(t){if(t instanceof E||t instanceof l)throw R.getNotFoundInstance();throw t}}static decode(t,e,r){const n=new Array,i=Pe.detectMultiple(t,e,r);for(const t of i.getPoints()){const e=nr.decode(i.getBits(),t[4],t[5],t[6],t[7],ir.getMinCodewordWidth(t),ir.getMaxCodewordWidth(t)),r=new F(e.getText(),e.getRawBytes(),void 0,t,k.PDF_417);r.putMetadata(W.ERROR_CORRECTION_LEVEL,e.getECLevel());const s=e.getOther();null!=s&&r.putMetadata(W.PDF417_EXTRA_METADATA,s),n.push(r)}return n.map(t=>t)}static getMaxWidth(t,e){return null==t||null==e?0:Math.trunc(Math.abs(t.getX()-e.getX()))}static getMinWidth(t,e){return null==t||null==e?f.MAX_VALUE:Math.trunc(Math.abs(t.getX()-e.getX()))}static getMaxCodewordWidth(t){return Math.floor(Math.max(Math.max(ir.getMaxWidth(t[0],t[4]),ir.getMaxWidth(t[6],t[2])*be.MODULES_IN_CODEWORD/be.MODULES_IN_STOP_PATTERN),Math.max(ir.getMaxWidth(t[1],t[5]),ir.getMaxWidth(t[7],t[3])*be.MODULES_IN_CODEWORD/be.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(t){return Math.floor(Math.min(Math.min(ir.getMinWidth(t[0],t[4]),ir.getMinWidth(t[6],t[2])*be.MODULES_IN_CODEWORD/be.MODULES_IN_STOP_PATTERN),Math.min(ir.getMinWidth(t[1],t[5]),ir.getMinWidth(t[7],t[3])*be.MODULES_IN_CODEWORD/be.MODULES_IN_STOP_PATTERN)))}reset(){}}class sr extends i{}sr.kind="ReaderException";class or{constructor(t){this.verbose=!0===t}decode(t,e){return this.setHints(e),this.decodeInternal(t)}decodeWithState(t){return null!==this.readers&&void 0!==this.readers||this.setHints(null),this.decodeInternal(t)}setHints(t){this.hints=t;const e=null!=t&&void 0!==t.get(C.TRY_HARDER),r=null==t?null:t.get(C.POSSIBLE_FORMATS),n=new Array;if(null!=r){const i=r.some(t=>t===k.UPC_A||t===k.UPC_E||t===k.EAN_13||t===k.EAN_8||t===k.CODABAR||t===k.CODE_39||t===k.CODE_93||t===k.CODE_128||t===k.ITF||t===k.RSS_14||t===k.RSS_EXPANDED);i&&!e&&n.push(new ee(t,this.verbose)),r.includes(k.QR_CODE)&&n.push(new Me),r.includes(k.DATA_MATRIX)&&n.push(new ue),r.includes(k.AZTEC)&&n.push(new dt),r.includes(k.PDF_417)&&n.push(new ir),i&&e&&n.push(new ee(t,this.verbose))}0===n.length&&(e||n.push(new ee(t,this.verbose)),n.push(new Me),n.push(new ue),n.push(new dt),n.push(new ir),e&&n.push(new ee(t,this.verbose))),this.readers=n}reset(){if(null!==this.readers)for(const t of this.readers)t.reset()}decodeInternal(t){if(null===this.readers)throw new sr("No readers where selected, nothing can be read.");for(const e of this.readers)try{return e.decode(t,this.hints)}catch(t){if(t instanceof sr)continue}throw new R("No MultiFormat Readers were able to detect the code.")}}var ar;!function(t){t[t.ERROR_CORRECTION=0]="ERROR_CORRECTION",t[t.CHARACTER_SET=1]="CHARACTER_SET",t[t.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",t[t.MIN_SIZE=3]="MIN_SIZE",t[t.MAX_SIZE=4]="MAX_SIZE",t[t.MARGIN=5]="MARGIN",t[t.PDF417_COMPACT=6]="PDF417_COMPACT",t[t.PDF417_COMPACTION=7]="PDF417_COMPACTION",t[t.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",t[t.AZTEC_LAYERS=9]="AZTEC_LAYERS",t[t.QR_VERSION=10]="QR_VERSION"}(ar||(ar={}));var lr=ar;class hr{constructor(t){this.field=t,this.cachedGenerators=[],this.cachedGenerators.push(new Z(t,Int32Array.from([1])))}buildGenerator(t){const e=this.cachedGenerators;if(t>=e.length){let r=e[e.length-1];const n=this.field;for(let i=e.length;i<=t;i++){const t=r.multiply(new Z(n,Int32Array.from([1,n.exp(i-1+n.getGeneratorBase())])));e.push(t),r=t}}return e[t]}encode(t,e){if(0===e)throw new o("No error correction bytes");const r=t.length-e;if(r<=0)throw new o("No data bytes provided");const n=this.buildGenerator(e),i=new Int32Array(r);c.arraycopy(t,0,i,0,r);let s=new Z(this.field,i);const a=(s=s.multiplyByMonomial(e,1)).divide(n)[1].getCoefficients(),l=e-a.length;for(let e=0;e<l;e++)t[r+e]=0;c.arraycopy(a,0,t,r+l,a.length)}}class cr{constructor(){}static applyMaskPenaltyRule1(t){return cr.applyMaskPenaltyRule1Internal(t,!0)+cr.applyMaskPenaltyRule1Internal(t,!1)}static applyMaskPenaltyRule2(t){let e=0;const r=t.getArray(),n=t.getWidth(),i=t.getHeight();for(let t=0;t<i-1;t++){const i=r[t];for(let s=0;s<n-1;s++){const n=i[s];n===i[s+1]&&n===r[t+1][s]&&n===r[t+1][s+1]&&e++}}return cr.N2*e}static applyMaskPenaltyRule3(t){let e=0;const r=t.getArray(),n=t.getWidth(),i=t.getHeight();for(let t=0;t<i;t++)for(let s=0;s<n;s++){const o=r[t];s+6<n&&1===o[s]&&0===o[s+1]&&1===o[s+2]&&1===o[s+3]&&1===o[s+4]&&0===o[s+5]&&1===o[s+6]&&(cr.isWhiteHorizontal(o,s-4,s)||cr.isWhiteHorizontal(o,s+7,s+11))&&e++,t+6<i&&1===r[t][s]&&0===r[t+1][s]&&1===r[t+2][s]&&1===r[t+3][s]&&1===r[t+4][s]&&0===r[t+5][s]&&1===r[t+6][s]&&(cr.isWhiteVertical(r,s,t-4,t)||cr.isWhiteVertical(r,s,t+7,t+11))&&e++}return e*cr.N3}static isWhiteHorizontal(t,e,r){e=Math.max(e,0),r=Math.min(r,t.length);for(let n=e;n<r;n++)if(1===t[n])return!1;return!0}static isWhiteVertical(t,e,r,n){r=Math.max(r,0),n=Math.min(n,t.length);for(let i=r;i<n;i++)if(1===t[i][e])return!1;return!0}static applyMaskPenaltyRule4(t){let e=0;const r=t.getArray(),n=t.getWidth(),i=t.getHeight();for(let t=0;t<i;t++){const i=r[t];for(let t=0;t<n;t++)1===i[t]&&e++}const s=t.getHeight()*t.getWidth();return Math.floor(10*Math.abs(2*e-s)/s)*cr.N4}static getDataMaskBit(t,e,r){let n,i;switch(t){case 0:n=r+e&1;break;case 1:n=1&r;break;case 2:n=e%3;break;case 3:n=(r+e)%3;break;case 4:n=Math.floor(r/2)+Math.floor(e/3)&1;break;case 5:n=(1&(i=r*e))+i%3;break;case 6:n=(1&(i=r*e))+i%3&1;break;case 7:n=(i=r*e)%3+(r+e&1)&1;break;default:throw new o("Invalid mask pattern: "+t)}return 0===n}static applyMaskPenaltyRule1Internal(t,e){let r=0;const n=e?t.getHeight():t.getWidth(),i=e?t.getWidth():t.getHeight(),s=t.getArray();for(let t=0;t<n;t++){let n=0,o=-1;for(let a=0;a<i;a++){const i=e?s[t][a]:s[a][t];i===o?n++:(n>=5&&(r+=cr.N1+(n-5)),n=1,o=i)}n>=5&&(r+=cr.N1+(n-5))}return r}}cr.N1=3,cr.N2=3,cr.N3=40,cr.N4=10;class ur{constructor(t,e){this.width=t,this.height=e;const r=new Array(e);for(let n=0;n!==e;n++)r[n]=new Uint8Array(t);this.bytes=r}getHeight(){return this.height}getWidth(){return this.width}get(t,e){return this.bytes[e][t]}getArray(){return this.bytes}setNumber(t,e,r){this.bytes[e][t]=r}setBoolean(t,e,r){this.bytes[e][t]=r?1:0}clear(t){for(const e of this.bytes)g.fill(e,t)}equals(t){if(!(t instanceof ur))return!1;const e=t;if(this.width!==e.width)return!1;if(this.height!==e.height)return!1;for(let t=0,r=this.height;t<r;++t){const r=this.bytes[t],n=e.bytes[t];for(let t=0,e=this.width;t<e;++t)if(r[t]!==n[t])return!1}return!0}toString(){const t=new p;for(let e=0,r=this.height;e<r;++e){const r=this.bytes[e];for(let e=0,n=this.width;e<n;++e)switch(r[e]){case 0:t.append(" 0");break;case 1:t.append(" 1");break;default:t.append("  ")}t.append("\n")}return t.toString()}}class dr{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const t=new p;return t.append("<<\n"),t.append(" mode: "),t.append(this.mode?this.mode.toString():"null"),t.append("\n ecLevel: "),t.append(this.ecLevel?this.ecLevel.toString():"null"),t.append("\n version: "),t.append(this.version?this.version.toString():"null"),t.append("\n maskPattern: "),t.append(this.maskPattern.toString()),this.matrix?(t.append("\n matrix:\n"),t.append(this.matrix.toString())):t.append("\n matrix: null\n"),t.append(">>\n"),t.toString()}setMode(t){this.mode=t}setECLevel(t){this.ecLevel=t}setVersion(t){this.version=t}setMaskPattern(t){this.maskPattern=t}setMatrix(t){this.matrix=t}static isValidMaskPattern(t){return t>=0&&t<dr.NUM_MASK_PATTERNS}}dr.NUM_MASK_PATTERNS=8;class gr extends i{}gr.kind="WriterException";class fr{constructor(){}static clearMatrix(t){t.clear(255)}static buildMatrix(t,e,r,n,i){fr.clearMatrix(i),fr.embedBasicPatterns(r,i),fr.embedTypeInfo(e,n,i),fr.maybeEmbedVersionInfo(r,i),fr.embedDataBits(t,n,i)}static embedBasicPatterns(t,e){fr.embedPositionDetectionPatternsAndSeparators(e),fr.embedDarkDotAtLeftBottomCorner(e),fr.maybeEmbedPositionAdjustmentPatterns(t,e),fr.embedTimingPatterns(e)}static embedTypeInfo(t,e,r){const n=new w;fr.makeTypeInfoBits(t,e,n);for(let t=0,e=n.getSize();t<e;++t){const e=n.get(n.getSize()-1-t),i=fr.TYPE_INFO_COORDINATES[t],s=i[0],o=i[1];if(r.setBoolean(s,o,e),t<8){const n=r.getWidth()-t-1,i=8;r.setBoolean(n,i,e)}else{const n=8,i=r.getHeight()-7+(t-8);r.setBoolean(n,i,e)}}}static maybeEmbedVersionInfo(t,e){if(t.getVersionNumber()<7)return;const r=new w;fr.makeVersionInfoBits(t,r);let n=17;for(let t=0;t<6;++t)for(let i=0;i<3;++i){const s=r.get(n);n--,e.setBoolean(t,e.getHeight()-11+i,s),e.setBoolean(e.getHeight()-11+i,t,s)}}static embedDataBits(t,e,r){let n=0,i=-1,s=r.getWidth()-1,o=r.getHeight()-1;for(;s>0;){for(6===s&&(s-=1);o>=0&&o<r.getHeight();){for(let i=0;i<2;++i){const a=s-i;if(!fr.isEmpty(r.get(a,o)))continue;let l;n<t.getSize()?(l=t.get(n),++n):l=!1,255!==e&&cr.getDataMaskBit(e,a,o)&&(l=!l),r.setBoolean(a,o,l)}o+=i}o+=i=-i,s-=2}if(n!==t.getSize())throw new gr("Not all bits consumed: "+n+"/"+t.getSize())}static findMSBSet(t){return 32-f.numberOfLeadingZeros(t)}static calculateBCHCode(t,e){if(0===e)throw new o("0 polynomial");const r=fr.findMSBSet(e);for(t<<=r-1;fr.findMSBSet(t)>=r;)t^=e<<fr.findMSBSet(t)-r;return t}static makeTypeInfoBits(t,e,r){if(!dr.isValidMaskPattern(e))throw new gr("Invalid mask pattern");const n=t.getBits()<<3|e;r.appendBits(n,5);const i=fr.calculateBCHCode(n,fr.TYPE_INFO_POLY);r.appendBits(i,10);const s=new w;if(s.appendBits(fr.TYPE_INFO_MASK_PATTERN,15),r.xor(s),15!==r.getSize())throw new gr("should not happen but we got: "+r.getSize())}static makeVersionInfoBits(t,e){e.appendBits(t.getVersionNumber(),6);const r=fr.calculateBCHCode(t.getVersionNumber(),fr.VERSION_INFO_POLY);if(e.appendBits(r,12),18!==e.getSize())throw new gr("should not happen but we got: "+e.getSize())}static isEmpty(t){return 255===t}static embedTimingPatterns(t){for(let e=8;e<t.getWidth()-8;++e){const r=(e+1)%2;fr.isEmpty(t.get(e,6))&&t.setNumber(e,6,r),fr.isEmpty(t.get(6,e))&&t.setNumber(6,e,r)}}static embedDarkDotAtLeftBottomCorner(t){if(0===t.get(8,t.getHeight()-8))throw new gr;t.setNumber(8,t.getHeight()-8,1)}static embedHorizontalSeparationPattern(t,e,r){for(let n=0;n<8;++n){if(!fr.isEmpty(r.get(t+n,e)))throw new gr;r.setNumber(t+n,e,0)}}static embedVerticalSeparationPattern(t,e,r){for(let n=0;n<7;++n){if(!fr.isEmpty(r.get(t,e+n)))throw new gr;r.setNumber(t,e+n,0)}}static embedPositionAdjustmentPattern(t,e,r){for(let n=0;n<5;++n){const i=fr.POSITION_ADJUSTMENT_PATTERN[n];for(let s=0;s<5;++s)r.setNumber(t+s,e+n,i[s])}}static embedPositionDetectionPattern(t,e,r){for(let n=0;n<7;++n){const i=fr.POSITION_DETECTION_PATTERN[n];for(let s=0;s<7;++s)r.setNumber(t+s,e+n,i[s])}}static embedPositionDetectionPatternsAndSeparators(t){const e=fr.POSITION_DETECTION_PATTERN[0].length;fr.embedPositionDetectionPattern(0,0,t),fr.embedPositionDetectionPattern(t.getWidth()-e,0,t),fr.embedPositionDetectionPattern(0,t.getWidth()-e,t);fr.embedHorizontalSeparationPattern(0,7,t),fr.embedHorizontalSeparationPattern(t.getWidth()-8,7,t),fr.embedHorizontalSeparationPattern(0,t.getWidth()-8,t);fr.embedVerticalSeparationPattern(7,0,t),fr.embedVerticalSeparationPattern(t.getHeight()-7-1,0,t),fr.embedVerticalSeparationPattern(7,t.getHeight()-7,t)}static maybeEmbedPositionAdjustmentPatterns(t,e){if(t.getVersionNumber()<2)return;const r=t.getVersionNumber()-1,n=fr.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[r];for(let t=0,r=n.length;t!==r;t++){const i=n[t];if(i>=0)for(let t=0;t!==r;t++){const r=n[t];r>=0&&fr.isEmpty(e.get(r,i))&&fr.embedPositionAdjustmentPattern(r-2,i-2,e)}}}}fr.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),fr.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),fr.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),fr.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),fr.VERSION_INFO_POLY=7973,fr.TYPE_INFO_POLY=1335,fr.TYPE_INFO_MASK_PATTERN=21522;class wr{constructor(t,e){this.dataBytes=t,this.errorCorrectionBytes=e}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class Ar{constructor(){}static calculateMaskPenalty(t){return cr.applyMaskPenaltyRule1(t)+cr.applyMaskPenaltyRule2(t)+cr.applyMaskPenaltyRule3(t)+cr.applyMaskPenaltyRule4(t)}static encode(t,e,r=null){let n=Ar.DEFAULT_BYTE_MODE_ENCODING;const i=null!==r&&void 0!==r.get(lr.CHARACTER_SET);i&&(n=r.get(lr.CHARACTER_SET).toString());const s=this.chooseMode(t,n),o=new w;if(s===_e.BYTE&&(i||Ar.DEFAULT_BYTE_MODE_ENCODING!==n)){const t=m.getCharacterSetECIByName(n);void 0!==t&&this.appendECI(t,o)}this.appendModeInfo(s,o);const a=new w;let l;if(this.appendBytes(t,s,a,n),null!==r&&void 0!==r.get(lr.QR_VERSION)){const t=Number.parseInt(r.get(lr.QR_VERSION).toString(),10);l=Ae.getVersionForNumber(t);const n=this.calculateBitsNeeded(s,o,a,l);if(!this.willFit(n,l,e))throw new gr("Data too big for requested version")}else l=this.recommendVersion(e,s,o,a);const h=new w;h.appendBitArray(o);const c=s===_e.BYTE?a.getSizeInBytes():t.length;this.appendLengthInfo(c,l,s,h),h.appendBitArray(a);const u=l.getECBlocksForLevel(e),d=l.getTotalCodewords()-u.getTotalECCodewords();this.terminateBits(d,h);const g=this.interleaveWithECBytes(h,l.getTotalCodewords(),d,u.getNumBlocks()),f=new dr;f.setECLevel(e),f.setMode(s),f.setVersion(l);const A=l.getDimensionForVersion(),C=new ur(A,A),E=this.chooseMaskPattern(g,e,l,C);return f.setMaskPattern(E),fr.buildMatrix(g,e,l,E,C),f.setMatrix(C),f}static recommendVersion(t,e,r,n){const i=this.calculateBitsNeeded(e,r,n,Ae.getVersionForNumber(1)),s=this.chooseVersion(i,t),o=this.calculateBitsNeeded(e,r,n,s);return this.chooseVersion(o,t)}static calculateBitsNeeded(t,e,r,n){return e.getSize()+t.getCharacterCountBits(n)+r.getSize()}static getAlphanumericCode(t){return t<Ar.ALPHANUMERIC_TABLE.length?Ar.ALPHANUMERIC_TABLE[t]:-1}static chooseMode(t,e=null){if(m.SJIS.getName()===e&&this.isOnlyDoubleByteKanji(t))return _e.KANJI;let r=!1,n=!1;for(let e=0,i=t.length;e<i;++e){const i=t.charAt(e);if(Ar.isDigit(i))r=!0;else{if(-1===this.getAlphanumericCode(i.charCodeAt(0)))return _e.BYTE;n=!0}}return n?_e.ALPHANUMERIC:r?_e.NUMERIC:_e.BYTE}static isOnlyDoubleByteKanji(t){let e;try{e=I.encode(t,m.SJIS)}catch(t){return!1}const r=e.length;if(r%2!=0)return!1;for(let t=0;t<r;t+=2){const r=255&e[t];if((r<129||r>159)&&(r<224||r>235))return!1}return!0}static chooseMaskPattern(t,e,r,n){let i=Number.MAX_SAFE_INTEGER,s=-1;for(let o=0;o<dr.NUM_MASK_PATTERNS;o++){fr.buildMatrix(t,e,r,o,n);let a=this.calculateMaskPenalty(n);a<i&&(i=a,s=o)}return s}static chooseVersion(t,e){for(let r=1;r<=40;r++){const n=Ae.getVersionForNumber(r);if(Ar.willFit(t,n,e))return n}throw new gr("Data too big")}static willFit(t,e,r){return e.getTotalCodewords()-e.getECBlocksForLevel(r).getTotalECCodewords()>=(t+7)/8}static terminateBits(t,e){const r=8*t;if(e.getSize()>r)throw new gr("data bits cannot fit in the QR Code"+e.getSize()+" > "+r);for(let t=0;t<4&&e.getSize()<r;++t)e.appendBit(!1);const n=7&e.getSize();if(n>0)for(let t=n;t<8;t++)e.appendBit(!1);const i=t-e.getSizeInBytes();for(let t=0;t<i;++t)e.appendBits(0==(1&t)?236:17,8);if(e.getSize()!==r)throw new gr("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(t,e,r,n,i,s){if(n>=r)throw new gr("Block ID too large");const o=t%r,a=r-o,l=Math.floor(t/r),h=l+1,c=Math.floor(e/r),u=c+1,d=l-c,g=h-u;if(d!==g)throw new gr("EC bytes mismatch");if(r!==a+o)throw new gr("RS blocks mismatch");if(t!==(c+d)*a+(u+g)*o)throw new gr("Total bytes mismatch");n<a?(i[0]=c,s[0]=d):(i[0]=u,s[0]=g)}static interleaveWithECBytes(t,e,r,n){if(t.getSizeInBytes()!==r)throw new gr("Number of bits and data bytes does not match");let i=0,s=0,o=0;const a=new Array;for(let l=0;l<n;++l){const h=new Int32Array(1),c=new Int32Array(1);Ar.getNumDataBytesAndNumECBytesForBlockID(e,r,n,l,h,c);const u=h[0],d=new Uint8Array(u);t.toBytes(8*i,d,0,u);const g=Ar.generateECBytes(d,c[0]);a.push(new wr(d,g)),s=Math.max(s,u),o=Math.max(o,g.length),i+=h[0]}if(r!==i)throw new gr("Data bytes does not match offset");const l=new w;for(let t=0;t<s;++t)for(const e of a){const r=e.getDataBytes();t<r.length&&l.appendBits(r[t],8)}for(let t=0;t<o;++t)for(const e of a){const r=e.getErrorCorrectionBytes();t<r.length&&l.appendBits(r[t],8)}if(e!==l.getSizeInBytes())throw new gr("Interleaving error: "+e+" and "+l.getSizeInBytes()+" differ.");return l}static generateECBytes(t,e){const r=t.length,n=new Int32Array(r+e);for(let e=0;e<r;e++)n[e]=255&t[e];new hr(q.QR_CODE_FIELD_256).encode(n,e);const i=new Uint8Array(e);for(let t=0;t<e;t++)i[t]=n[r+t];return i}static appendModeInfo(t,e){e.appendBits(t.getBits(),4)}static appendLengthInfo(t,e,r,n){const i=r.getCharacterCountBits(e);if(t>=1<<i)throw new gr(t+" is bigger than "+((1<<i)-1));n.appendBits(t,i)}static appendBytes(t,e,r,n){switch(e){case _e.NUMERIC:Ar.appendNumericBytes(t,r);break;case _e.ALPHANUMERIC:Ar.appendAlphanumericBytes(t,r);break;case _e.BYTE:Ar.append8BitBytes(t,r,n);break;case _e.KANJI:Ar.appendKanjiBytes(t,r);break;default:throw new gr("Invalid mode: "+e)}}static getDigit(t){return t.charCodeAt(0)-48}static isDigit(t){const e=Ar.getDigit(t);return e>=0&&e<=9}static appendNumericBytes(t,e){const r=t.length;let n=0;for(;n<r;){const i=Ar.getDigit(t.charAt(n));if(n+2<r){const r=Ar.getDigit(t.charAt(n+1)),s=Ar.getDigit(t.charAt(n+2));e.appendBits(100*i+10*r+s,10),n+=3}else if(n+1<r){const r=Ar.getDigit(t.charAt(n+1));e.appendBits(10*i+r,7),n+=2}else e.appendBits(i,4),n++}}static appendAlphanumericBytes(t,e){const r=t.length;let n=0;for(;n<r;){const i=Ar.getAlphanumericCode(t.charCodeAt(n));if(-1===i)throw new gr;if(n+1<r){const r=Ar.getAlphanumericCode(t.charCodeAt(n+1));if(-1===r)throw new gr;e.appendBits(45*i+r,11),n+=2}else e.appendBits(i,6),n++}}static append8BitBytes(t,e,r){let n;try{n=I.encode(t,r)}catch(t){throw new gr(t)}for(let t=0,r=n.length;t!==r;t++){const r=n[t];e.appendBits(r,8)}}static appendKanjiBytes(t,e){let r;try{r=I.encode(t,m.SJIS)}catch(t){throw new gr(t)}const n=r.length;for(let t=0;t<n;t+=2){const n=(255&r[t])<<8&4294967295|255&r[t+1];let i=-1;if(n>=33088&&n<=40956?i=n-33088:n>=57408&&n<=60351&&(i=n-49472),-1===i)throw new gr("Invalid byte sequence");const s=192*(i>>8)+(255&i);e.appendBits(s,13)}}static appendECI(t,e){e.appendBits(_e.ECI.getBits(),4),e.appendBits(t.getValue(),8)}}Ar.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),Ar.DEFAULT_BYTE_MODE_ENCODING=m.UTF8.getName();class Cr{write(t,e,r,n=null){if(0===t.length)throw new o("Found empty contents");if(e<0||r<0)throw new o("Requested dimensions are too small: "+e+"x"+r);let i=de.L,s=Cr.QUIET_ZONE_SIZE;null!==n&&(void 0!==n.get(lr.ERROR_CORRECTION)&&(i=de.fromString(n.get(lr.ERROR_CORRECTION).toString())),void 0!==n.get(lr.MARGIN)&&(s=Number.parseInt(n.get(lr.MARGIN).toString(),10)));const a=Ar.encode(t,i,n);return this.renderResult(a,e,r,s)}writeToDom(t,e,r,n,i=null){"string"==typeof t&&(t=document.querySelector(t));const s=this.write(e,r,n,i);t&&t.appendChild(s)}renderResult(t,e,r,n){const i=t.getMatrix();if(null===i)throw new j;const s=i.getWidth(),o=i.getHeight(),a=s+2*n,l=o+2*n,h=Math.max(e,a),c=Math.max(r,l),u=Math.min(Math.floor(h/a),Math.floor(c/l)),d=Math.floor((h-s*u)/2),g=Math.floor((c-o*u)/2),f=this.createSVGElement(h,c);for(let t=0,e=g;t<o;t++,e+=u)for(let r=0,n=d;r<s;r++,n+=u)if(1===i.get(r,t)){const t=this.createSvgRectElement(n,e,u,u);f.appendChild(t)}return f}createSVGElement(t,e){const r=document.createElementNS(Cr.SVG_NS,"svg");return r.setAttributeNS(null,"height",t.toString()),r.setAttributeNS(null,"width",e.toString()),r}createSvgRectElement(t,e,r,n){const i=document.createElementNS(Cr.SVG_NS,"rect");return i.setAttributeNS(null,"x",t.toString()),i.setAttributeNS(null,"y",e.toString()),i.setAttributeNS(null,"height",r.toString()),i.setAttributeNS(null,"width",n.toString()),i.setAttributeNS(null,"fill","#000000"),i}}Cr.QUIET_ZONE_SIZE=4,Cr.SVG_NS="http://www.w3.org/2000/svg";class Er{encode(t,e,r,n,i){if(0===t.length)throw new o("Found empty contents");if(e!==k.QR_CODE)throw new o("Can only encode QR_CODE, but got "+e);if(r<0||n<0)throw new o(`Requested dimensions are too small: ${r}x${n}`);let s=de.L,a=Er.QUIET_ZONE_SIZE;null!==i&&(void 0!==i.get(lr.ERROR_CORRECTION)&&(s=de.fromString(i.get(lr.ERROR_CORRECTION).toString())),void 0!==i.get(lr.MARGIN)&&(a=Number.parseInt(i.get(lr.MARGIN).toString(),10)));const l=Ar.encode(t,s,i);return Er.renderResult(l,r,n,a)}static renderResult(t,e,r,n){const i=t.getMatrix();if(null===i)throw new j;const s=i.getWidth(),o=i.getHeight(),a=s+2*n,l=o+2*n,h=Math.max(e,a),c=Math.max(r,l),u=Math.min(Math.floor(h/a),Math.floor(c/l)),d=Math.floor((h-s*u)/2),g=Math.floor((c-o*u)/2),f=new T(h,c);for(let t=0,e=g;t<o;t++,e+=u)for(let r=0,n=d;r<s;r++,n+=u)1===i.get(r,t)&&f.setRegion(n,e,u,u);return f}}Er.QUIET_ZONE_SIZE=4;class mr extends y{constructor(t,e,r,n,i,s,a,l){if(super(s,a),this.yuvData=t,this.dataWidth=e,this.dataHeight=r,this.left=n,this.top=i,n+s>e||i+a>r)throw new o("Crop rectangle does not fit within image data.");l&&this.reverseHorizontal(s,a)}getRow(t,e){if(t<0||t>=this.getHeight())throw new o("Requested row is outside the image: "+t);const r=this.getWidth();(null==e||e.length<r)&&(e=new Uint8ClampedArray(r));const n=(t+this.top)*this.dataWidth+this.left;return c.arraycopy(this.yuvData,n,e,0,r),e}getMatrix(){const t=this.getWidth(),e=this.getHeight();if(t===this.dataWidth&&e===this.dataHeight)return this.yuvData;const r=t*e,n=new Uint8ClampedArray(r);let i=this.top*this.dataWidth+this.left;if(t===this.dataWidth)return c.arraycopy(this.yuvData,i,n,0,r),n;for(let r=0;r<e;r++){const e=r*t;c.arraycopy(this.yuvData,i,n,e,t),i+=this.dataWidth}return n}isCropSupported(){return!0}crop(t,e,r,n){return new mr(this.yuvData,this.dataWidth,this.dataHeight,this.left+t,this.top+e,r,n,!1)}renderThumbnail(){const t=this.getWidth()/mr.THUMBNAIL_SCALE_FACTOR,e=this.getHeight()/mr.THUMBNAIL_SCALE_FACTOR,r=new Int32Array(t*e),n=this.yuvData;let i=this.top*this.dataWidth+this.left;for(let s=0;s<e;s++){const e=s*t;for(let s=0;s<t;s++){const t=255&n[i+s*mr.THUMBNAIL_SCALE_FACTOR];r[e+s]=4278190080|65793*t}i+=this.dataWidth*mr.THUMBNAIL_SCALE_FACTOR}return r}getThumbnailWidth(){return this.getWidth()/mr.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/mr.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(t,e){const r=this.yuvData;for(let n=0,i=this.top*this.dataWidth+this.left;n<e;n++,i+=this.dataWidth){const e=i+t/2;for(let n=i,s=i+t-1;n<e;n++,s--){const t=r[n];r[n]=r[s],r[s]=t}}}invert(){return new O(this)}}mr.THUMBNAIL_SCALE_FACTOR=2;class _r extends y{constructor(t,e,r,n,i,s,a){if(super(e,r),this.dataWidth=n,this.dataHeight=i,this.left=s,this.top=a,4===t.BYTES_PER_ELEMENT){const n=e*r,i=new Uint8ClampedArray(n);for(let e=0;e<n;e++){const r=t[e],n=r>>16&255,s=r>>7&510,o=255&r;i[e]=(n+s+o)/4&255}this.luminances=i}else this.luminances=t;if(void 0===n&&(this.dataWidth=e),void 0===i&&(this.dataHeight=r),void 0===s&&(this.left=0),void 0===a&&(this.top=0),this.left+e>this.dataWidth||this.top+r>this.dataHeight)throw new o("Crop rectangle does not fit within image data.")}getRow(t,e){if(t<0||t>=this.getHeight())throw new o("Requested row is outside the image: "+t);const r=this.getWidth();(null==e||e.length<r)&&(e=new Uint8ClampedArray(r));const n=(t+this.top)*this.dataWidth+this.left;return c.arraycopy(this.luminances,n,e,0,r),e}getMatrix(){const t=this.getWidth(),e=this.getHeight();if(t===this.dataWidth&&e===this.dataHeight)return this.luminances;const r=t*e,n=new Uint8ClampedArray(r);let i=this.top*this.dataWidth+this.left;if(t===this.dataWidth)return c.arraycopy(this.luminances,i,n,0,r),n;for(let r=0;r<e;r++){const e=r*t;c.arraycopy(this.luminances,i,n,e,t),i+=this.dataWidth}return n}isCropSupported(){return!0}crop(t,e,r,n){return new _r(this.luminances,r,n,this.dataWidth,this.dataHeight,this.left+t,this.top+e)}invert(){return new O(this)}}class Ir extends m{static forName(t){return this.getCharacterSetECIByName(t)}}class Sr{}Sr.ISO_8859_1=m.ISO8859_1;class pr{isCompact(){return this.compact}setCompact(t){this.compact=t}getSize(){return this.size}setSize(t){this.size=t}getLayers(){return this.layers}setLayers(t){this.layers=t}getCodeWords(){return this.codeWords}setCodeWords(t){this.codeWords=t}getMatrix(){return this.matrix}setMatrix(t){this.matrix=t}}class Tr{static singletonList(t){return[t]}static min(t,e){return t.sort(e)[0]}}class Rr{constructor(t){this.previous=t}getPrevious(){return this.previous}}class Nr extends Rr{constructor(t,e,r){super(t),this.value=e,this.bitCount=r}appendTo(t,e){t.appendBits(this.value,this.bitCount)}add(t,e){return new Nr(this,t,e)}addBinaryShift(t,e){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Nr(this,t,e)}toString(){let t=this.value&(1<<this.bitCount)-1;return t|=1<<this.bitCount,"<"+f.toBinaryString(t|1<<this.bitCount).substring(1)+">"}}class Dr extends Nr{constructor(t,e,r){super(t,0,0),this.binaryShiftStart=e,this.binaryShiftByteCount=r}appendTo(t,e){for(let r=0;r<this.binaryShiftByteCount;r++)(0===r||31===r&&this.binaryShiftByteCount<=62)&&(t.appendBits(31,5),this.binaryShiftByteCount>62?t.appendBits(this.binaryShiftByteCount-31,16):0===r?t.appendBits(Math.min(this.binaryShiftByteCount,31),5):t.appendBits(this.binaryShiftByteCount-31,5)),t.appendBits(e[this.binaryShiftStart+r],8)}addBinaryShift(t,e){return new Dr(this,t,e)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function yr(t,e,r){return new Nr(t,e,r)}const Or=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Mr=0,br=1,Br=2,Pr=3,Lr=4,Fr=new Nr(null,0,0),vr=[Int32Array.from([0,327708,327710,327709,656318]),Int32Array.from([590318,0,327710,327709,656318]),Int32Array.from([262158,590300,0,590301,932798]),Int32Array.from([327709,327708,656318,0,327710]),Int32Array.from([327711,656380,656382,656381,0])];const kr=function(t){for(let e of t)g.fill(e,-1);return t[Mr][Lr]=0,t[br][Lr]=0,t[br][Mr]=28,t[Pr][Lr]=0,t[Br][Lr]=0,t[Br][Mr]=15,t}(g.createInt32Array(6,6));class xr{constructor(t,e,r,n){this.token=t,this.mode=e,this.binaryShiftByteCount=r,this.bitCount=n}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(t,e){let r=this.bitCount,n=this.token;if(t!==this.mode){let e=vr[this.mode][t];n=yr(n,65535&e,e>>16),r+=e>>16}let i=t===Br?4:5;return n=yr(n,e,i),new xr(n,t,0,r+i)}shiftAndAppend(t,e){let r=this.token,n=this.mode===Br?4:5;return r=yr(r,kr[this.mode][t],n),r=yr(r,e,5),new xr(r,this.mode,0,this.bitCount+n+5)}addBinaryShiftChar(t){let e=this.token,r=this.mode,n=this.bitCount;if(this.mode===Lr||this.mode===Br){let t=vr[r][Mr];e=yr(e,65535&t,t>>16),n+=t>>16,r=Mr}let i=0===this.binaryShiftByteCount||31===this.binaryShiftByteCount?18:62===this.binaryShiftByteCount?9:8,s=new xr(e,r,this.binaryShiftByteCount+1,n+i);return 2078===s.binaryShiftByteCount&&(s=s.endBinaryShift(t+1)),s}endBinaryShift(t){if(0===this.binaryShiftByteCount)return this;let e=this.token;return e=function(t,e,r){return new Dr(t,e,r)}(e,t-this.binaryShiftByteCount,this.binaryShiftByteCount),new xr(e,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(t){let e=this.bitCount+(vr[this.mode][t.mode]>>16);return this.binaryShiftByteCount<t.binaryShiftByteCount?e+=xr.calculateBinaryShiftCost(t)-xr.calculateBinaryShiftCost(this):this.binaryShiftByteCount>t.binaryShiftByteCount&&t.binaryShiftByteCount>0&&(e+=10),e<=t.bitCount}toBitArray(t){let e=[];for(let r=this.endBinaryShift(t.length).token;null!==r;r=r.getPrevious())e.unshift(r);let r=new w;for(const n of e)n.appendTo(r,t);return r}toString(){return S.format("%s bits=%d bytes=%d",Or[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(t){return t.binaryShiftByteCount>62?21:t.binaryShiftByteCount>31?20:t.binaryShiftByteCount>0?10:0}}xr.INITIAL_STATE=new xr(Fr,Mr,0,0);const Vr=function(t){const e=S.getCharCode(" "),r=S.getCharCode("."),n=S.getCharCode(",");t[Mr][e]=1;const i=S.getCharCode("Z"),s=S.getCharCode("A");for(let e=s;e<=i;e++)t[Mr][e]=e-s+2;t[br][e]=1;const o=S.getCharCode("z"),a=S.getCharCode("a");for(let e=a;e<=o;e++)t[br][e]=e-a+2;t[Br][e]=1;const l=S.getCharCode("9"),h=S.getCharCode("0");for(let e=h;e<=l;e++)t[Br][e]=e-h+2;t[Br][n]=12,t[Br][r]=13;const c=["\0"," ","","","","","","","","\b","\t","\n","\v","\f","\r","","","","","","@","\\","^","_","`","|","~",""];for(let e=0;e<c.length;e++)t[Pr][S.getCharCode(c[e])]=e;const u=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let e=0;e<u.length;e++)S.getCharCode(u[e])>0&&(t[Lr][S.getCharCode(u[e])]=e);return t}(g.createInt32Array(5,256));class Ur{constructor(t){this.text=t}encode(){const t=S.getCharCode(" "),e=S.getCharCode("\n");let r=Tr.singletonList(xr.INITIAL_STATE);for(let n=0;n<this.text.length;n++){let i,s=n+1<this.text.length?this.text[n+1]:0;switch(this.text[n]){case S.getCharCode("\r"):i=s===e?2:0;break;case S.getCharCode("."):i=s===t?3:0;break;case S.getCharCode(","):i=s===t?4:0;break;case S.getCharCode(":"):i=s===t?5:0;break;default:i=0}i>0?(r=Ur.updateStateListForPair(r,n,i),n++):r=this.updateStateListForChar(r,n)}return Tr.min(r,(t,e)=>t.getBitCount()-e.getBitCount()).toBitArray(this.text)}updateStateListForChar(t,e){const r=[];for(let n of t)this.updateStateForChar(n,e,r);return Ur.simplifyStates(r)}updateStateForChar(t,e,r){let n=255&this.text[e],i=Vr[t.getMode()][n]>0,s=null;for(let o=0;o<=Lr;o++){let a=Vr[o][n];if(a>0){if(null==s&&(s=t.endBinaryShift(e)),!i||o===t.getMode()||o===Br){const t=s.latchAndAppend(o,a);r.push(t)}if(!i&&kr[t.getMode()][o]>=0){const t=s.shiftAndAppend(o,a);r.push(t)}}}if(t.getBinaryShiftByteCount()>0||0===Vr[t.getMode()][n]){let n=t.addBinaryShiftChar(e);r.push(n)}}static updateStateListForPair(t,e,r){const n=[];for(let i of t)this.updateStateForPair(i,e,r,n);return this.simplifyStates(n)}static updateStateForPair(t,e,r,n){let i=t.endBinaryShift(e);if(n.push(i.latchAndAppend(Lr,r)),t.getMode()!==Lr&&n.push(i.shiftAndAppend(Lr,r)),3===r||4===r){let t=i.latchAndAppend(Br,16-r).latchAndAppend(Br,1);n.push(t)}if(t.getBinaryShiftByteCount()>0){let r=t.addBinaryShiftChar(e).addBinaryShiftChar(e+1);n.push(r)}}static simplifyStates(t){let e=[];for(const r of t){let t=!0;for(const n of e){if(n.isBetterThanOrEqualTo(r)){t=!1;break}r.isBetterThanOrEqualTo(n)&&(e=e.filter(t=>t!==n))}t&&e.push(r)}return e}}class Hr{constructor(){}static encodeBytes(t){return Hr.encode(t,Hr.DEFAULT_EC_PERCENT,Hr.DEFAULT_AZTEC_LAYERS)}static encode(t,e,r){let n,i,s,a,l,h=new Ur(t).encode(),c=f.truncDivision(h.getSize()*e,100)+11,u=h.getSize()+c;if(r!==Hr.DEFAULT_AZTEC_LAYERS){if(n=r<0,(i=Math.abs(r))>(n?Hr.MAX_NB_BITS_COMPACT:Hr.MAX_NB_BITS))throw new o(S.format("Illegal value %s for layers",r));let t=(s=Hr.totalBitsInLayer(i,n))-s%(a=Hr.WORD_SIZE[i]);if((l=Hr.stuffBits(h,a)).getSize()+c>t)throw new o("Data to large for user specified layer");if(n&&l.getSize()>64*a)throw new o("Data to large for user specified layer")}else{a=0,l=null;for(let t=0;;t++){if(t>Hr.MAX_NB_BITS)throw new o("Data too large for an Aztec code");if(i=(n=t<=3)?t+1:t,u>(s=Hr.totalBitsInLayer(i,n)))continue;null!=l&&a===Hr.WORD_SIZE[i]||(a=Hr.WORD_SIZE[i],l=Hr.stuffBits(h,a));let e=s-s%a;if(!(n&&l.getSize()>64*a)&&l.getSize()+c<=e)break}}let d,g=Hr.generateCheckWords(l,s,a),w=l.getSize()/a,A=Hr.generateModeMessage(n,i,w),C=(n?11:14)+4*i,E=new Int32Array(C);if(n){d=C;for(let t=0;t<E.length;t++)E[t]=t}else{d=C+1+2*f.truncDivision(f.truncDivision(C,2)-1,15);let t=f.truncDivision(C,2),e=f.truncDivision(d,2);for(let r=0;r<t;r++){let n=r+f.truncDivision(r,15);E[t-r-1]=e-n-1,E[t+r]=e+n+1}}let m=new T(d);for(let t=0,e=0;t<i;t++){let r=4*(i-t)+(n?9:12);for(let n=0;n<r;n++){let i=2*n;for(let s=0;s<2;s++)g.get(e+i+s)&&m.set(E[2*t+s],E[2*t+n]),g.get(e+2*r+i+s)&&m.set(E[2*t+n],E[C-1-2*t-s]),g.get(e+4*r+i+s)&&m.set(E[C-1-2*t-s],E[C-1-2*t-n]),g.get(e+6*r+i+s)&&m.set(E[C-1-2*t-n],E[2*t+s])}e+=8*r}if(Hr.drawModeMessage(m,n,d,A),n)Hr.drawBullsEye(m,f.truncDivision(d,2),5);else{Hr.drawBullsEye(m,f.truncDivision(d,2),7);for(let t=0,e=0;t<f.truncDivision(C,2)-1;t+=15,e+=16)for(let t=1&f.truncDivision(d,2);t<d;t+=2)m.set(f.truncDivision(d,2)-e,t),m.set(f.truncDivision(d,2)+e,t),m.set(t,f.truncDivision(d,2)-e),m.set(t,f.truncDivision(d,2)+e)}let _=new pr;return _.setCompact(n),_.setSize(d),_.setLayers(i),_.setCodeWords(w),_.setMatrix(m),_}static drawBullsEye(t,e,r){for(let n=0;n<r;n+=2)for(let r=e-n;r<=e+n;r++)t.set(r,e-n),t.set(r,e+n),t.set(e-n,r),t.set(e+n,r);t.set(e-r,e-r),t.set(e-r+1,e-r),t.set(e-r,e-r+1),t.set(e+r,e-r),t.set(e+r,e-r+1),t.set(e+r,e+r-1)}static generateModeMessage(t,e,r){let n=new w;return t?(n.appendBits(e-1,2),n.appendBits(r-1,6),n=Hr.generateCheckWords(n,28,4)):(n.appendBits(e-1,5),n.appendBits(r-1,11),n=Hr.generateCheckWords(n,40,4)),n}static drawModeMessage(t,e,r,n){let i=f.truncDivision(r,2);if(e)for(let e=0;e<7;e++){let r=i-3+e;n.get(e)&&t.set(r,i-5),n.get(e+7)&&t.set(i+5,r),n.get(20-e)&&t.set(r,i+5),n.get(27-e)&&t.set(i-5,r)}else for(let e=0;e<10;e++){let r=i-5+e+f.truncDivision(e,5);n.get(e)&&t.set(r,i-7),n.get(e+10)&&t.set(i+7,r),n.get(29-e)&&t.set(r,i+7),n.get(39-e)&&t.set(i-7,r)}}static generateCheckWords(t,e,r){let n=t.getSize()/r,i=new hr(Hr.getGF(r)),s=f.truncDivision(e,r),o=Hr.bitsToWords(t,r,s);i.encode(o,s-n);let a=e%r,l=new w;l.appendBits(0,a);for(const t of Array.from(o))l.appendBits(t,r);return l}static bitsToWords(t,e,r){let n,i,s=new Int32Array(r);for(n=0,i=t.getSize()/e;n<i;n++){let r=0;for(let i=0;i<e;i++)r|=t.get(n*e+i)?1<<e-i-1:0;s[n]=r}return s}static getGF(t){switch(t){case 4:return q.AZTEC_PARAM;case 6:return q.AZTEC_DATA_6;case 8:return q.AZTEC_DATA_8;case 10:return q.AZTEC_DATA_10;case 12:return q.AZTEC_DATA_12;default:throw new o("Unsupported word size "+t)}}static stuffBits(t,e){let r=new w,n=t.getSize(),i=(1<<e)-2;for(let s=0;s<n;s+=e){let o=0;for(let r=0;r<e;r++)(s+r>=n||t.get(s+r))&&(o|=1<<e-1-r);(o&i)===i?(r.appendBits(o&i,e),s--):0==(o&i)?(r.appendBits(1|o,e),s--):r.appendBits(o,e)}return r}static totalBitsInLayer(t,e){return((e?88:112)+16*t)*t}}Hr.DEFAULT_EC_PERCENT=33,Hr.DEFAULT_AZTEC_LAYERS=0,Hr.MAX_NB_BITS=32,Hr.MAX_NB_BITS_COMPACT=4,Hr.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Gr{encode(t,e,r,n){return this.encodeWithHints(t,e,r,n,null)}encodeWithHints(t,e,r,n,i){let s=Sr.ISO_8859_1,o=Hr.DEFAULT_EC_PERCENT,a=Hr.DEFAULT_AZTEC_LAYERS;return null!=i&&(i.has(lr.CHARACTER_SET)&&(s=Ir.forName(i.get(lr.CHARACTER_SET).toString())),i.has(lr.ERROR_CORRECTION)&&(o=f.parseInt(i.get(lr.ERROR_CORRECTION).toString())),i.has(lr.AZTEC_LAYERS)&&(a=f.parseInt(i.get(lr.AZTEC_LAYERS).toString()))),Gr.encodeLayers(t,e,r,n,s,o,a)}static encodeLayers(t,e,r,n,i,s,a){if(e!==k.AZTEC)throw new o("Can only encode AZTEC, but got "+e);let l=Hr.encode(S.getBytes(t,i),s,a);return Gr.renderResult(l,r,n)}static renderResult(t,e,r){let n=t.getMatrix();if(null==n)throw new j;let i=n.getWidth(),s=n.getHeight(),o=Math.max(e,i),a=Math.max(r,s),l=Math.min(o/i,a/s),h=(o-i*l)/2,c=(a-s*l)/2,u=new T(o,a);for(let t=0,e=c;t<s;t++,e+=l)for(let r=0,s=h;r<i;r++,s+=l)n.get(r,t)&&u.setRegion(s,e,l,l);return u}}t.ArgumentException=s,t.ArithmeticException=K,t.AztecCode=pr,t.AztecCodeReader=dt,t.AztecCodeWriter=Gr,t.AztecDecoder=$,t.AztecDetector=ut,t.AztecDetectorResult=it,t.AztecEncoder=Hr,t.AztecHighLevelEncoder=Ur,t.AztecPoint=ct,t.BarcodeFormat=k,t.Binarizer=h,t.BinaryBitmap=a,t.BitArray=w,t.BitMatrix=T,t.BitSource=ae,t.BrowserAztecCodeReader=class extends L{constructor(t=500){super(new dt,t)}},t.BrowserBarcodeReader=class extends L{constructor(t=500,e){super(new ee(e),t,e)}},t.BrowserCodeReader=L,t.BrowserDatamatrixCodeReader=class extends L{constructor(t=500){super(new ue,t)}},t.BrowserMultiFormatReader=class extends L{constructor(t=null,e=500){const r=new or;r.setHints(t),super(r,e)}decodeBitmap(t){return this.reader.decodeWithState(t)}},t.BrowserPDF417Reader=class extends L{constructor(t=500){super(new ir,t)}},t.BrowserQRCodeReader=class extends L{constructor(t=500){super(new Me,t)}},t.BrowserQRCodeSvgWriter=Cr,t.CharacterSetECI=m,t.ChecksumException=l,t.Code128Reader=ft,t.Code39Reader=wt,t.DataMatrixDecodedBitStreamParser=le,t.DataMatrixReader=ue,t.DecodeHintType=C,t.DecoderResult=z,t.DefaultGridSampler=lt,t.DetectorResult=nt,t.EAN13Reader=St,t.EncodeHintType=lr,t.Exception=i,t.FormatException=E,t.GenericGF=q,t.GenericGFPoly=Z,t.GlobalHistogramBinarizer=N,t.GridSampler=ot,t.GridSamplerInstance=ht,t.HTMLCanvasElementLuminanceSource=M,t.HybridBinarizer=D,t.ITFReader=At,t.IllegalArgumentException=o,t.IllegalStateException=j,t.InvertedLuminanceSource=O,t.LuminanceSource=y,t.MathUtils=tt,t.MultiFormatOneDReader=ee,t.MultiFormatReader=or,t.MultiFormatWriter=class{encode(t,e,r,n,i){let s;switch(e){case k.QR_CODE:s=new Er;break;default:throw new o("No encoder available for format "+e)}return s.encode(t,e,r,n,i)}},t.NotFoundException=R,t.OneDReader=gt,t.PDF417DecodedBitStreamParser=rr,t.PDF417DecoderErrorCorrection=ke,t.PDF417Reader=ir,t.PDF417ResultMetadata=Ze,t.PerspectiveTransform=at,t.PlanarYUVLuminanceSource=mr,t.QRCodeByteMatrix=ur,t.QRCodeDataMask=Ce,t.QRCodeDecodedBitStreamParser=Ie,t.QRCodeDecoderErrorCorrectionLevel=de,t.QRCodeDecoderFormatInformation=ge,t.QRCodeEncoder=Ar,t.QRCodeEncoderQRCode=dr,t.QRCodeMaskUtil=cr,t.QRCodeMatrixUtil=fr,t.QRCodeMode=_e,t.QRCodeReader=Me,t.QRCodeVersion=Ae,t.QRCodeWriter=Er,t.RGBLuminanceSource=_r,t.RSS14Reader=te,t.RSSExpandedReader=Jt,t.ReaderException=sr,t.ReedSolomonDecoder=J,t.ReedSolomonEncoder=hr,t.ReedSolomonException=Q,t.Result=F,t.ResultMetadataType=W,t.ResultPoint=rt,t.StringUtils=S,t.UnsupportedOperationException=_,t.VideoInputDevice=b,t.WhiteRectangleDetector=st,t.WriterException=gr,t.ZXingArrays=g,t.ZXingCharset=Ir,t.ZXingInteger=f,t.ZXingStandardCharsets=Sr,t.ZXingStringBuilder=p,t.ZXingStringEncoding=I,t.ZXingSystem=c,Object.defineProperty(t,"__esModule",{value:!0})});"use strict";function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var Html5Qrcode=function(){function a(b,c){if(_classCallCheck(this,a),!ZXing)throw"Use html5qrcode.min.js without edit, ZXing not found.";var d=new Map,e=[ZXing.BarcodeFormat.QR_CODE,ZXing.BarcodeFormat.AZTEC,ZXing.BarcodeFormat.CODABAR,ZXing.BarcodeFormat.CODE_39,ZXing.BarcodeFormat.CODE_93,ZXing.BarcodeFormat.CODE_128,ZXing.BarcodeFormat.DATA_MATRIX,ZXing.BarcodeFormat.MAXICODE,ZXing.BarcodeFormat.ITF,ZXing.BarcodeFormat.EAN_13,ZXing.BarcodeFormat.EAN_8,ZXing.BarcodeFormat.PDF_417,ZXing.BarcodeFormat.RSS_14,ZXing.BarcodeFormat.RSS_EXPANDED,ZXing.BarcodeFormat.UPC_A,ZXing.BarcodeFormat.UPC_E,ZXing.BarcodeFormat.UPC_EAN_EXTENSION];d.set(ZXing.DecodeHintType.POSSIBLE_FORMATS,e),this.qrcode=new ZXing.MultiFormatReader(c),this.qrcode.setHints(d),this._elementId=b,this._foreverScanTimeout=null,this._localMediaStream=null,this._shouldScan=!0,this._url=window.URL||window.webkitURL||window.mozURL||window.msURL,this._userMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,this._isScanning=!1,a.VERBOSE=!0===c}return _createClass(a,[{key:"start",value:function(b,c,d,e){var f=this;if(!b)throw"cameraIdOrConfig is required";if(!d||"function"!=typeof d)throw"qrCodeSuccessCallback is required and should be a function.";e||(e=console.log),this._clearElement();var g=this,h=c?c:{};h.fps=h.fps?h.fps:a.SCAN_DEFAULT_FPS;var i=!1;h.videoConstraints&&(this._isMediaStreamConstraintsValid(h.videoConstraints)?i=!0:a._logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var j=i,k=null!=h.qrbox,l=document.getElementById(this._elementId),m=l.clientWidth?l.clientWidth:a.DEFAULT_WIDTH;if(l.style.position="relative",this._shouldScan=!0,this._element=l,k){var n=h.qrbox;if(n<a.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' is"+" ".concat(a.MIN_QR_BOX_SIZE,"px.");if(n>m)throw"'config.qrbox' should not be greater than the width of the HTML element."}var o=function(a,b){var c=h.qrbox;c>b&&console.warn("[Html5Qrcode] config.qrboxsize is greater than video height. Shading will be ignored");var d=k&&c<=b,e=d?f._getShadedRegionBounds(a,b,c):{x:0,y:0,width:a,height:b},i=f._createCanvasElement(e.width,e.height),j=i.getContext("2d");j.canvas.width=e.width,j.canvas.height=e.height,l.append(i),d&&f._possiblyInsertShadingElement(l,a,b,c),g._qrRegion=e,g._context=j,g._canvasElement=i},p=function(){try{var a=new ZXing.HTMLCanvasElementLuminanceSource(g._canvasElement),b=new ZXing.BinaryBitmap(new ZXing.HybridBinarizer(a)),c=g.qrcode.decode(b);return d(c.text),f._possiblyUpdateShaders(!0),!0}catch(a){return f._possiblyUpdateShaders(!1),e("QR code parse error, error = ".concat(a)),!1}},q=function b(){if(g._shouldScan){if(g._localMediaStream){var c=g._videoElement,d=c.videoWidth/c.clientWidth,e=c.videoHeight/c.clientHeight,i=g._qrRegion.width*d,j=g._qrRegion.height*e,k=g._qrRegion.x*d,l=g._qrRegion.y*e;g._context.drawImage(g._videoElement,k,l,i,j,0,0,g._qrRegion.width,g._qrRegion.height),p()||!0===h.disableFlip||(f._context.translate(f._context.canvas.width,0),f._context.scale(-1,1),p())}g._foreverScanTimeout=setTimeout(b,a._getTimeoutFps(h.fps))}},r=function(a){return new Promise(function(b,c){var d=function(){var d=f._createVideoElement(m);g._element.append(d),d.onabort=c,d.onerror=c,d.onplaying=function(){var a=d.clientWidth,c=d.clientHeight;o(a,c),q(),b()},d.srcObject=a,d.play(),g._videoElement=d};if(g._localMediaStream=a,j||!h.aspectRatio)d();else{var e={aspectRatio:h.aspectRatio},i=a.getVideoTracks()[0];i.applyConstraints(e).then(function(){return d()})["catch"](function(a){console.log("[Warning] [Html5Qrcode] Constriants could not be satisfied, ignoring constraints",a),d()})}})};return new Promise(function(a,c){if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){var d=j?h.videoConstraints:g._createVideoConstraints(b);navigator.mediaDevices.getUserMedia({audio:!1,video:d}).then(function(b){r(b).then(function(){g._isScanning=!0,a()})["catch"](c)})["catch"](function(a){c("Error getting userMedia, error = ".concat(a))})}else if(navigator.getUserMedia){if("string"!=typeof b)throw"The device doesn't support navigator.mediaDevices, only supported cameraIdOrConfig in this case is deviceId parameter (string).";navigator.getUserMedia({video:{optional:[{sourceId:b}]}},function(b){r(b).then(function(){g._isScanning=!0,a()})["catch"](c)},function(a){c("Error getting userMedia, error = ".concat(a))})}else c("Web camera streaming not supported by the browser.")})}},{key:"stop",value:function(){this._shouldScan=!1,clearTimeout(this._foreverScanTimeout);var b=this;return new Promise(function(c){var d=b._localMediaStream.getVideoTracks().length,e=0,f=function(){for(;b._element.getElementsByClassName(a.SHADED_REGION_CLASSNAME).length;){var c=b._element.getElementsByClassName(a.SHADED_REGION_CLASSNAME)[0];b._element.removeChild(c)}},g=function(){b._localMediaStream=null,b._element.removeChild(b._videoElement),b._element.removeChild(b._canvasElement),f(),b._isScanning=!1,b._qrRegion&&(b._qrRegion=null),b._context&&(b._context=null),c(!0)};b._localMediaStream.getVideoTracks().forEach(function(a){b._localMediaStream.removeTrack(a),a.stop(),++e,e>=d&&g()})})}},{key:"scanFile",value:function(b,c){var d=this;if(!b||!(b instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'";if(c=void 0===c||c,d._isScanning)throw"Close ongoing scan before scanning a file.";var e=function b(c,d,e,f){if(c<=e&&d<=f){var g=(e-c)/2,h=(f-d)/2;return{x:g,y:h,width:c,height:d}}var i=c,j=d;return c>e&&(d=e/c*d,c=e),d>f&&(c=f/d*c,d=f),a._log("Image downsampled from "+"".concat(i,"X").concat(j)+" to ".concat(c,"X").concat(d,".")),b(c,d,e,f)};return new Promise(function(f,g){d._possiblyCloseLastScanImageFile(),d._clearElement(),d._lastScanImageFile=b;var h=new Image;h.onload=function(){var b=Math.max,i=h.width,j=h.height,k=document.getElementById(d._elementId),l=k.clientWidth?k.clientWidth:a.DEFAULT_WIDTH,m=b(k.clientHeight?k.clientHeight:j,a.FILE_SCAN_MIN_HEIGHT),n=e(i,j,l,m);if(c){var o=d._createCanvasElement(l,m,"qr-canvas-visible");o.style.display="inline-block",k.appendChild(o);var p=o.getContext("2d");p.canvas.width=l,p.canvas.height=m,p.drawImage(h,0,0,i,j,n.x,n.y,n.width,n.height)}var q=d._createCanvasElement(n.width,n.height);k.appendChild(q);var r=q.getContext("2d");r.canvas.width=n.width,r.canvas.height=n.height,r.drawImage(h,0,0,i,j,0,0,n.width,n.height);try{var s=new ZXing.HTMLCanvasElementLuminanceSource(q),t=new ZXing.BinaryBitmap(new ZXing.HybridBinarizer(s)),u=d.qrcode.decode(t);f(u.text)}catch(a){g("QR code parse error, error = ".concat(a))}},h.onerror=g,h.onabort=g,h.onstalled=g,h.onsuspend=g,h.src=URL.createObjectURL(b)})}},{key:"clear",value:function(){this._clearElement()}},{key:"getRunningTrackCapabilities",value:function(){if(null==this._localMediaStream)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";if(0==this._localMediaStream.getVideoTracks().length)throw"No video tracks found";var a=this._localMediaStream.getVideoTracks()[0];return a.getCapabilities()}},{key:"applyVideoConstraints",value:function(a){var b=this;if(!a)throw"videoConstaints is required argument.";else if(!this._isMediaStreamConstraintsValid(a))throw"invalid videoConstaints passed, check logs for more details";if(null==this._localMediaStream)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";if(0==this._localMediaStream.getVideoTracks().length)throw"No video tracks found";return new Promise(function(c,d){if("aspectRatio"in a)return void d("Chaning 'aspectRatio' in run-time is not yet supported.");var e=b._localMediaStream.getVideoTracks()[0];e.applyConstraints(a).then(function(a){c(a)})["catch"](function(a){d(a)})})}},{key:"_clearElement",value:function(){if(this._isScanning)throw"Cannot clear while scan is ongoing, close it first.";var a=document.getElementById(this._elementId);a.innerHTML=""}},{key:"_createCanvasElement",value:function(a,b,c){var d=document.createElement("canvas");return d.style.width="".concat(a,"px"),d.style.height="".concat(b,"px"),d.style.display="none",d.id=null==c?"qr-canvas":c,d}},{key:"_createVideoElement",value:function(a){var b=document.createElement("video");return b.style.width="".concat(a,"px"),b.muted=!0,b.playsInline=!0,b}},{key:"_getShadedRegionBounds",value:function(a,b,c){if(c>a||c>b)throw"'config.qrbox' should not be greater than the width and height of the HTML element.";return{x:(a-c)/2,y:(b-c)/2,width:c,height:c}}},{key:"_possiblyInsertShadingElement",value:function(b,c,d,e){if(!(1>c-e||1>d-e)){var f=document.createElement("div");if(f.style.position="absolute",f.style.borderLeft="".concat((c-e)/2,"px solid #0000007a"),f.style.borderRight="".concat((c-e)/2,"px solid #0000007a"),f.style.borderTop="".concat((d-e)/2,"px solid #0000007a"),f.style.borderBottom="".concat((d-e)/2,"px solid #0000007a"),f.style.boxSizing="border-box",f.style.top="0px",f.style.bottom="0px",f.style.left="0px",f.style.right="0px",f.id="".concat(a.SHADED_REGION_CLASSNAME),11>c-e||11>d-e)this.hasBorderShaders=!1;else{this._insertShaderBorders(f,40,5,-5,0,!0),this._insertShaderBorders(f,40,5,-5,0,!1),this._insertShaderBorders(f,40,5,e+5,0,!0),this._insertShaderBorders(f,40,5,e+5,0,!1),this._insertShaderBorders(f,5,45,-5,-5,!0),this._insertShaderBorders(f,5,45,e+5-40,-5,!0),this._insertShaderBorders(f,5,45,-5,-5,!1),this._insertShaderBorders(f,5,45,e+5-40,-5,!1),this.hasBorderShaders=!0}b.append(f)}}},{key:"_insertShaderBorders",value:function(b,c,d,e,f,g){var h=document.createElement("div");h.style.position="absolute",h.style.backgroundColor=a.BORDER_SHADER_DEFAULT_COLOR,h.style.width="".concat(c,"px"),h.style.height="".concat(d,"px"),h.style.top="".concat(e,"px"),g?h.style.left="".concat(f,"px"):h.style.right="".concat(f,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(h),b.appendChild(h)}},{key:"_possiblyUpdateShaders",value:function(b){this.qrMatch===b||(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(c){c.style.backgroundColor=b?a.BORDER_SHADER_MATCH_COLOR:a.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=b)}},{key:"_possiblyCloseLastScanImageFile",value:function(){this._lastScanImageFile&&(URL.revokeObjectURL(this._lastScanImageFile),this._lastScanImageFile=null)}},{key:"_createVideoConstraints",value:function(a){if("string"==typeof a)return{deviceId:{exact:a}};if("object"==_typeof(a)){var b={user:!0,environment:!0},c=function(a){if(a in b)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(a,"'")},d=Object.keys(a);if(1!=d.length)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(d.length," keys");var e=Object.keys(a)[0];if("facingMode"!=e&&"deviceId"!=e)throw"Only '".concat("facingMode","' and '").concat("deviceId","' ")+" are supported for 'cameraIdOrConfig'";if("facingMode"==e){var f=a[e];if("string"==typeof f){if(c(f))return{facingMode:f};}else if("object"!=_typeof(f)){var g=_typeof(f);throw"Invalid type of 'facingMode' = ".concat(g)}else if(!("exact"in f))throw"'facingMode' should be string or object with"+" ".concat("exact"," as key.");else if(c(f.exact))return{facingMode:{exact:f.exact}}}else{var h=a[e];if("string"==typeof h)return{deviceId:h};if("object"==_typeof(h)){if("exact"in h)return{deviceId:{exact:h.exact}};throw"'deviceId' should be string or object with"+" ".concat("exact"," as key.")}else{var i=_typeof(h);throw"Invalid type of 'deviceId' = ".concat(i)}}}else{var j=_typeof(a);throw"Invalid type of 'cameraIdOrConfig' = ".concat(j)}}},{key:"_isMediaStreamConstraintsValid",value:function(b){if(!b)return a._logError("Empty videoConstraints",!0),!1;if("object"!==_typeof(b)){var c=_typeof(b);return a._logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(c,"."),!0),!1}for(var d,e=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],f=new Set(e),g=Object.keys(b),h=0;h<g.length;h++)if(d=g[h],f.has(d))return a._logError("".concat(d," is not supported videoConstaints."),!0),!1;return!0}}],[{key:"getCameras",value:function(){var a=this;return new Promise(function(b,c){if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&navigator.mediaDevices.getUserMedia)a._log("navigator.mediaDevices used"),navigator.mediaDevices.getUserMedia({audio:!1,video:!0}).then(function(d){d.oninactive=function(){return a._log("All streams closed")};var e=function(a){for(var b,c=a.getVideoTracks(),d=0;d<c.length;d++)b=c[d],b.enabled=!1,b.stop(),a.removeTrack(b)};navigator.mediaDevices.enumerateDevices().then(function(c){for(var f,g=[],h=0;h<c.length;h++)f=c[h],"videoinput"==f.kind&&g.push({id:f.deviceId,label:f.label});a._log("".concat(g.length," results found")),e(d),b(g)})["catch"](function(a){c("".concat(a.name," : ").concat(a.message))})})["catch"](function(a){c("".concat(a.name," : ").concat(a.message))});else if(MediaStreamTrack&&MediaStreamTrack.getSources){a._log("MediaStreamTrack.getSources used");var d=function(c){for(var d,e=[],f=0;f!==c.length;++f)d=c[f],"video"===d.kind&&e.push({id:d.id,label:d.label});a._log("".concat(e.length," results found")),b(e)};MediaStreamTrack.getSources(d)}else{var e=function(){if("https:"===location.protocol)return!0;var a=location.host.split(":")[0];return"127.0.0.1"===a||"localhost"===a},f="Unable to query supported devices, unknown error.";e()||(f="Camera access is only supported in secure context like https or localhost."),a._log(f),c(f)}})}},{key:"_getTimeoutFps",value:function(a){return 1e3/a}},{key:"_log",value:function(b){a.VERBOSE&&console.log(b)}},{key:"_logError",value:function(b,c){(a.VERBOSE||!0===c)&&console.error(b)}}]),a}();_defineProperty(Html5Qrcode,"DEFAULT_WIDTH",300),_defineProperty(Html5Qrcode,"DEFAULT_WIDTH_OFFSET",2),_defineProperty(Html5Qrcode,"FILE_SCAN_MIN_HEIGHT",300),_defineProperty(Html5Qrcode,"SCAN_DEFAULT_FPS",2),_defineProperty(Html5Qrcode,"MIN_QR_BOX_SIZE",50),_defineProperty(Html5Qrcode,"SHADED_LEFT",1),_defineProperty(Html5Qrcode,"SHADED_RIGHT",2),_defineProperty(Html5Qrcode,"SHADED_TOP",3),_defineProperty(Html5Qrcode,"SHADED_BOTTOM",4),_defineProperty(Html5Qrcode,"SHADED_REGION_CLASSNAME","qr-shaded-region"),_defineProperty(Html5Qrcode,"VERBOSE",!1),_defineProperty(Html5Qrcode,"BORDER_SHADER_DEFAULT_COLOR","#ffffff"),_defineProperty(Html5Qrcode,"BORDER_SHADER_MATCH_COLOR","rgb(90, 193, 56)");

/** Html5QrcodeScanner **/
"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var Html5QrcodeScanner=function(){function a(b,c,d){if(_classCallCheck(this,a),this.elementId=b,this.config=c,this.verbose=!0===d,!document.getElementById(b))throw"HTML Element with id=".concat(b," not found");this.currentScanType=a.SCAN_TYPE_CAMERA,this.sectionSwapAllowed=!0,this.section=void 0,this.html5Qrcode=void 0,this.qrCodeSuccessCallback=void 0,this.qrCodeErrorCallback=void 0}return _createClass(a,[{key:"render",value:function(b,c){var d=this;this.lastMatchFound=void 0,this.qrCodeSuccessCallback=function(c){if(d.__setStatus("MATCH",a.STATUS_SUCCESS),b)b(c);else{if(d.lastMatchFound==c)return;d.lastMatchFound=c,d.__setHeaderMessage("Last Match: ".concat(c),a.STATUS_SUCCESS)}},this.qrCodeErrorCallback=function(a){d.__setStatus("Scanning"),c&&c(a)};var e=document.getElementById(this.elementId);e.innerHTML="",this.__createBasicLayout(e),this.html5Qrcode=new Html5Qrcode(this.__getScanRegionId(),this.verbose)}},{key:"clear",value:function(){var a=this,b=this,c=function(){var b=document.getElementById(a.elementId);b&&(b.innerHTML="",a.__resetBasicLayout(b))};if(this.html5Qrcode)return new Promise(function(a,d){b.html5Qrcode._isScanning&&b.html5Qrcode.stop().then(function(){b.html5Qrcode.clear(),c(),a()})["catch"](function(a){b.verbose&&console.error("Unable to stop qrcode scanner",a),d(a)})})}},{key:"__createBasicLayout",value:function(a){a.style.position="relative",a.style.padding="0px",a.style.border="1px solid silver",this.__createHeader(a);var b=document.createElement("div"),c=this.__getScanRegionId();b.id=c,b.style.width="100%",b.style.minHeight="100px",b.style.textAlign="center",a.appendChild(b),this.__insertCameraScanImageToScanRegion();var d=document.createElement("div"),e=this.__getDashboardId();d.id=e,d.style.width="100%",a.appendChild(d),this.__setupInitialDashboard(d)}},{key:"__resetBasicLayout",value:function(a){a.style.border="none"}},{key:"__setupInitialDashboard",value:function(a){this.__createSection(a),this.__createSectionControlPanel(),this.__createSectionSwap()}},{key:"__createHeader",value:function(a){var b=document.createElement("div");b.style.textAlign="left",b.style.margin="0px",b.style.padding="5px",b.style.fontSize="20px",b.style.borderBottom="1px solid rgba(192, 192, 192, 0.18)",a.appendChild(b);var c=document.createElement("span"),d=document.createElement("a");d.innerHTML="Code Scanner",d.href="https://github.com/mebjas/html5-qrcode",c.appendChild(d),b.appendChild(c);var e=document.createElement("span");e.id=this.__getStatusSpanId(),e.style.float="right",e.style.padding="5px 7px",e.style.fontSize="14px",e.style.background="#dedede6b",e.style.border="1px solid #00000000",e.style.color="rgb(17, 17, 17)",b.appendChild(e),this.__setStatus("IDLE");var f=document.createElement("div");f.id=this.__getHeaderMessageContainerId(),f.style.display="none",f.style.fontSize="14px",f.style.padding="2px 10px",f.style.marginTop="4px",f.style.borderTop="1px solid #f6f6f6",b.appendChild(f)}},{key:"__createSection",value:function(a){var b=document.createElement("div");b.id=this.__getDashboardSectionId(),b.style.width="100%",b.style.padding="10px",b.style.textAlign="left",a.appendChild(b)}},{key:"__createSectionControlPanel",value:function(){var b=this,c=document.getElementById(this.__getDashboardSectionId()),d=document.createElement("div");c.appendChild(d);var e=document.createElement("div");e.id=this.__getDashboardSectionCameraScanRegionId(),e.style.display=this.currentScanType==a.SCAN_TYPE_CAMERA?"block":"none",d.appendChild(e);var f=document.createElement("div");f.style.textAlign="center";var g=document.createElement("button");g.innerHTML="Request Camera Permissions",g.addEventListener("click",function(){g.disabled=!0,b.__setStatus("PERMISSION"),b.__setHeaderMessage("Requesting camera permissions..."),Html5Qrcode.getCameras().then(function(c){b.__setStatus("IDLE"),b.__resetHeaderMessage(),c&&0!=c.length?(e.removeChild(f),b.__renderCameraSelection(c)):b.__setStatus("No Cameras",a.STATUS_WARNING)})["catch"](function(c){g.disabled=!1,b.__setStatus("IDLE"),b.__setHeaderMessage(c,a.STATUS_WARNING)})}),f.appendChild(g),e.appendChild(f);var h=document.createElement("div");h.id=this.__getDashboardSectionFileScanRegionId(),h.style.textAlign="center",h.style.display=this.currentScanType==a.SCAN_TYPE_CAMERA?"none":"block",d.appendChild(h);var i=document.createElement("input");i.id=this.__getFileScanInputId(),i.accept="image/*",i.type="file",i.style.width="200px",i.disabled=this.currentScanType==a.SCAN_TYPE_CAMERA;var j=document.createElement("span");j.innerHTML="&nbsp; Select Image",h.appendChild(i),h.appendChild(j),i.addEventListener("change",function(c){if(b.currentScanType===a.SCAN_TYPE_FILE&&0!=c.target.files.length){var d=c.target.files[0];b.html5Qrcode.scanFile(d,!0).then(function(a){b.__resetHeaderMessage(),b.qrCodeSuccessCallback(a)})["catch"](function(c){b.__setStatus("ERROR",a.STATUS_WARNING),b.__setHeaderMessage(c,a.STATUS_WARNING),b.qrCodeErrorCallback(c)})}})}},{key:"__renderCameraSelection",value:function(b){var c=this,d=document.getElementById(this.__getDashboardSectionCameraScanRegionId());d.style.textAlign="center";var e=document.createElement("span");e.innerHTML="Select Camera (".concat(b.length,") &nbsp;"),e.style.marginRight="10px";var f=document.createElement("select");f.id=this.__getCameraSelectionId();for(var g=0;g<b.length;g++){var h=b[g],j=h.id,k=null==h.label?j:h.label,l=document.createElement("option");l.value=j,l.innerHTML=k,f.appendChild(l)}e.appendChild(f),d.appendChild(e);var m=document.createElement("span"),n=document.createElement("button");n.innerHTML="Start Scanning",m.appendChild(n);var o=document.createElement("button");o.innerHTML="Stop Scanning",o.style.display="none",o.disabled=!0,m.appendChild(o),d.appendChild(m),n.addEventListener("click",function(){f.disabled=!0,n.disabled=!0,c._showHideScanTypeSwapLink(!1);var b=c.config?c.config:{fps:10,qrbox:250},d=f.value;c.html5Qrcode.start(d,b,c.qrCodeSuccessCallback,c.qrCodeErrorCallback).then(function(){o.disabled=!1,o.style.display="inline-block",n.style.display="none",c.__setStatus("Scanning")})["catch"](function(b){c._showHideScanTypeSwapLink(!0),f.disabled=!1,n.disabled=!1,c.__setStatus("IDLE"),c.__setHeaderMessage(b,a.STATUS_WARNING)})}),o.addEventListener("click",function(){o.disabled=!0,c.html5Qrcode.stop().then(function(){c._showHideScanTypeSwapLink(!0),f.disabled=!1,n.disabled=!1,o.style.display="none",n.style.display="inline-block",c.__setStatus("IDLE"),c.__insertCameraScanImageToScanRegion()})["catch"](function(b){o.disabled=!1,c.__setStatus("ERROR",a.STATUS_WARNING),c.__setHeaderMessage(b,a.STATUS_WARNING)})})}},{key:"__createSectionSwap",value:function(){var b=this,c="Scan an Image File",d="Scan using camera directly",e=document.getElementById(this.__getDashboardSectionId()),f=document.createElement("div");f.style.textAlign="center";var g=document.createElement("a");g.style.textDecoration="underline",g.id=this.__getDashboardSectionSwapLinkId(),g.innerHTML=this.currentScanType==a.SCAN_TYPE_CAMERA?c:d,g.href="#scan-using-file",g.addEventListener("click",function(){return b.sectionSwapAllowed?void(b.__setStatus("IDLE"),b.__resetHeaderMessage(),b.__getFileScanInput().value="",b.sectionSwapAllowed=!1,b.currentScanType==a.SCAN_TYPE_CAMERA?(b.__clearScanRegion(),b.__getFileScanInput().disabled=!1,b.__getCameraScanRegion().style.display="none",b.__getFileScanRegion().style.display="block",g.innerHTML=d,b.currentScanType=a.SCAN_TYPE_FILE,b.__insertFileScanImageToScanRegion()):(b.__clearScanRegion(),b.__getFileScanInput().disabled=!0,b.__getCameraScanRegion().style.display="block",b.__getFileScanRegion().style.display="none",g.innerHTML=c,b.currentScanType=a.SCAN_TYPE_CAMERA,b.__insertCameraScanImageToScanRegion()),b.sectionSwapAllowed=!0):void(b.verbose&&console.error("Section swap called when not allowed"))}),f.appendChild(g),e.appendChild(f)}},{key:"__setStatus",value:function(b,c){c||(c=a.STATUS_DEFAULT);var d=document.getElementById(this.__getStatusSpanId());switch(d.innerHTML=b,c){case a.STATUS_SUCCESS:d.style.background="#6aaf5042",d.style.color="#477735";break;case a.STATUS_WARNING:d.style.background="#cb243124",d.style.color="#cb2431";break;case a.STATUS_DEFAULT:default:d.style.background="#eef",d.style.color="rgb(17, 17, 17)";}}},{key:"__resetHeaderMessage",value:function(){var a=document.getElementById(this.__getHeaderMessageContainerId());a.style.display="none"}},{key:"__setHeaderMessage",value:function(b,c){c||(c=a.STATUS_DEFAULT);var d=document.getElementById(this.__getHeaderMessageContainerId());switch(d.innerHTML=b,d.style.display="block",c){case a.STATUS_SUCCESS:d.style.background="#6aaf5042",d.style.color="#477735";break;case a.STATUS_WARNING:d.style.background="#cb243124",d.style.color="#cb2431";break;case a.STATUS_DEFAULT:default:d.style.background="#00000000",d.style.color="rgb(17, 17, 17)";}}},{key:"_showHideScanTypeSwapLink",value:function(a){!0!==a&&(a=!1),this.sectionSwapAllowed=a,this.__getDashboardSectionSwapLink().style.display=a?"inline-block":"none"}},{key:"__insertCameraScanImageToScanRegion",value:function(){var b=this,c=document.getElementById(this.__getScanRegionId());return this.cameraScanImage?(c.innerHTML="<br>",void c.appendChild(this.cameraScanImage)):void(this.cameraScanImage=new Image,this.cameraScanImage.onload=function(){c.innerHTML="<br>",c.appendChild(b.cameraScanImage)},this.cameraScanImage.width=64,this.cameraScanImage.style.opacity=.3,this.cameraScanImage.src=a.ASSET_CAMERA_SCAN)}},{key:"__insertFileScanImageToScanRegion",value:function(){var b=this,c=document.getElementById(this.__getScanRegionId());return this.fileScanImage?(c.innerHTML="<br>",void c.appendChild(this.fileScanImage)):void(this.fileScanImage=new Image,this.fileScanImage.onload=function(){c.innerHTML="<br>",c.appendChild(b.fileScanImage)},this.fileScanImage.width=64,this.fileScanImage.style.opacity=.3,this.fileScanImage.src=a.ASSET_FILE_SCAN)}},{key:"__clearScanRegion",value:function(){var a=document.getElementById(this.__getScanRegionId());a.innerHTML=""}},{key:"__getDashboardSectionId",value:function(){return"".concat(this.elementId,"__dashboard_section")}},{key:"__getDashboardSectionCameraScanRegionId",value:function(){return"".concat(this.elementId,"__dashboard_section_csr")}},{key:"__getDashboardSectionFileScanRegionId",value:function(){return"".concat(this.elementId,"__dashboard_section_fsr")}},{key:"__getDashboardSectionSwapLinkId",value:function(){return"".concat(this.elementId,"__dashboard_section_swaplink")}},{key:"__getScanRegionId",value:function(){return"".concat(this.elementId,"__scan_region")}},{key:"__getDashboardId",value:function(){return"".concat(this.elementId,"__dashboard")}},{key:"__getFileScanInputId",value:function(){return"".concat(this.elementId,"__filescan_input")}},{key:"__getStatusSpanId",value:function(){return"".concat(this.elementId,"__status_span")}},{key:"__getHeaderMessageContainerId",value:function(){return"".concat(this.elementId,"__header_message")}},{key:"__getCameraSelectionId",value:function(){return"".concat(this.elementId,"__camera_selection")}},{key:"__getCameraScanRegion",value:function(){return document.getElementById(this.__getDashboardSectionCameraScanRegionId())}},{key:"__getFileScanRegion",value:function(){return document.getElementById(this.__getDashboardSectionFileScanRegionId())}},{key:"__getFileScanInput",value:function(){return document.getElementById(this.__getFileScanInputId())}},{key:"__getDashboardSectionSwapLink",value:function(){return document.getElementById(this.__getDashboardSectionSwapLinkId())}}]),a}();_defineProperty(Html5QrcodeScanner,"SCAN_TYPE_CAMERA","SCAN_TYPE_CAMERA"),_defineProperty(Html5QrcodeScanner,"SCAN_TYPE_FILE","SCAN_TYPE_FILE"),_defineProperty(Html5QrcodeScanner,"STATUS_SUCCESS","STATUS_SUCCESS"),_defineProperty(Html5QrcodeScanner,"STATUS_WARNING","STATUS_WARNING"),_defineProperty(Html5QrcodeScanner,"STATUS_DEFAULT","STATUS_DEFAULT"),_defineProperty(Html5QrcodeScanner,"ASSET_FILE_SCAN","https://raw.githubusercontent.com/mebjas/html5-qrcode/master/assets/file-scan.gif"),_defineProperty(Html5QrcodeScanner,"ASSET_CAMERA_SCAN","https://raw.githubusercontent.com/mebjas/html5-qrcode/master/assets/camera-scan.gif");
